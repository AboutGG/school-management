<div class="container-fluid py-3 bg-light">
  
  <div class="row">
    <div class="col-md-3">
      <div style="cursor: pointer;" class="card card-body-count text-left bg-success mb-2"  data-bs-toggle="modal" data-bs-target="#exampleModal">
        <div class="row justify-content-between">
          <div class="col-10">
            <h3 *ngIf="!isTeacher" class="mb-0 text-white">{{count.Users}}</h3>
            <h5 class="text-uppercase text-white">{{isTeacher ? 'Nuova Circolare' : 'Utenti'}}</h5>
          </div>
          <div class="col-2 align-self-center p-0">
            <i *ngIf="isTeacher" class="bi bi-file-earmark-plus text-white fs-1 w-100"></i>
            <i *ngIf="!isTeacher" class="bi bi-person-gear text-white fs-1 w-100"></i>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div  class="card card-body-count bg-danger mb-2">
        <div class="row">
          <div class="col-10">
            <h3 class="mb-0 text-white">{{count.Classrooms}}</h3>
            <span class="text-uppercase text-white">Classi</span>
          </div>
          <div class="col-2 align-self-center p-0">
            <i class="bi bi-people-fill text-white fs-1 w-100"></i>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card card-body-count bg-warning mb-2">
        <div class="row">
          <div class="col-10">
            <h3 class="mb-0 text-white">{{count.Students}}</h3>
            <span class="text-uppercase text-white">Studenti</span>
          </div>
          <div class="col-2 align-self-center p-0">
            <i class="bi bi-person-square text-white fs-1 w-100"></i>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card card-body-count bg-info mb-2">
        <div class="row">
          <div class="col-10">
            <h3 class="mb-0 text-white">{{count.Teachers}}</h3>
            <span class="text-uppercase text-white">Insegnanti</span>
          </div>
          <div class="col-2 align-self-center p-0">
            <i class="bi bi-person-video3 text-white fs-1 w-100"></i>
          </div>
        </div>
      </div>
    </div>
    <hr>

  </div>
  <div class="row">
    <div class="col-md-6">
      <div style="margin-top: 20px;" class="card card-left">
        <h5 class="card-header">Bacheca</h5>
        <div style="display: flex; flex-direction: column;" class="card-body">
          <div *ngFor="let pdf of pdfs"  style="margin-bottom: 15px;" class="card">
            <div style="background-color: #ffd45f; " class="card-body">
              <h6 class=" text-uppercase card-title">{{pdf.title}} <p style="text-align: end;"><img style="width: 32px;" class="" [src]="pdf.img"  alt="logo" ></p></h6>
              <hr>
              <p style="margin-top: 0; margin-bottom: 0;" class="">{{pdf.data}}</p>
              
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div [ngClass]="{'card-left' : isTeacher, 'card-right-esami' : !isTeacher}" style="margin-top: 20px;" class="card card-right-esami">
        <h5 class="card-header">Prossimi Esami</h5>
        <div style="display: flex; flex-direction: column" class="card-body card-body-bacheca">
          <ng-container *ngIf="examsTeachers && examsTeachers.length || examsStudents && examsStudents.length > 0; else noExams">
            <div *ngIf="isTeacher">
            <div *ngFor="let exam of examsTeachers" style="margin-bottom: 15px;" class="card">
              <div style="background-color: #ffd45f;" class="card-body">
                <h6 class=" text-uppercase card-title">{{exam.subject.name}}</h6>
                <p class="card-text">{{ exam.date | date: "dd/MM/yyyy"}}</p>
                <hr>
                <p style="text-align: end;" class=" card-text">{{'Classe ' + exam.classroom.name }}</p> 
              </div>
            </div>
          </div>
          <div *ngIf="!isTeacher">
            <div *ngFor="let exam of examsStudents" style="margin-bottom: 15px;" class="card">
              <div style="background-color: #ffd45f;" class="card-body">
                <h6 class=" text-uppercase card-title">{{exam.subject}}</h6>
                <p class="card-text">{{ exam.date | date: "dd/MM/yyyy"}}</p>
                <hr>
                <p style="text-align: end;" class=" card-text">{{'Prof. ' + exam.teacher }}</p> 
              </div>
            </div>
          </div>
          </ng-container>
          <ng-template #noExams>
          <div class="card" style="margin-bottom: 50px;">
            <div style="background-color: #ffd45f;" class="card-body">
            <h6 class="text-uppercase text-center card-title">{{ 'Non ci sono esami in programma' }}</h6>
            </div>
          </div>
          </ng-template>
            <button [routerLink]="[isTeacher ? '/teachers/exams' : '/students/exams']" style="display: flex; align-items: center; justify-content: center;" class="text-center btn card-button">Vai ai prossimi esami<i style="font-size: 11px; width: 20px; height: 13px;" class="bi bi-chevron-double-right"></i></button>
        </div>
      </div>
      
    
      <div *ngIf="!isTeacher" class="col-md-12">
        <div style="margin-top: 20px;" class="card card-right-pagella">
          <h5 class="card-header">Pagella</h5>
          <div class="card-body">
            <div  style="margin-bottom: 15px;" class="card">
              <div style="background-color: #ffd45f;" class="card-body d-flex justify-content-between">
                <h6 class=" text-uppercase card-title">{{pagella.title}}</h6> <img style="width: 32px;" class="" [src]="pagella.img"  alt="logo" >     
              </div>
            </div>
          </div>
        </div>    
      </div>     
    </div>
  </div>

<!-- Modal Circolari -->
<div *ngIf="isTeacher" class="modal fade" id="exampleModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div style="background-color: #1d1e2c; color: white;" class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Nuova Circolare</h5>
        <button style="background-color: white; color: white;" type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="editForm">
          <div class="d-flex flex-column">
            <div class="row">
            <div class="col-md-4">
              <label for="circularNumber">N° Circolare</label>
            <input id="circularNumber" type="number" formControlName="circularNumber">
            <p class="text-danger" *ngIf="!editForm.get('circularNumber')!.valid && editForm.get('circularNumber')!.touched">Inserisci un N° Circolare</p>
          </div>
          <div class="col-md-4">
            <label for="location">Luogo</label>
            <input id="location" type="text" formControlName="location" placeholder="Es: Roma">
            <p class="text-danger" *ngIf="!editForm.get('location')!.valid && editForm.get('location')!.touched">Inserisci un luogo</p>
          </div>

          <div class="col-md-4">
            <label for="uploadDate">Data</label>
            <input id="uploadDate" type= "date" formControlName="uploadDate">
            <p class="text-danger" *ngIf="!editForm.get('uploadDate')!.valid && editForm.get('uploadDate')!.touched">Inserisci una data</p>           
          </div>
        </div>

        <div class="row">
          <div class="col-md-6">
            <label for="object">Oggetto</label>
            <input id="object" type="text" formControlName="object" placeholder="Es: Nuovo Ordinamento Scolastico...">
            <p class="text-danger" *ngIf="!editForm.get('object')!.valid && editForm.get('object')!.touched">Inserisci un oggetto</p>
           
          </div>
          <div class="col-md-6">
            <label for="header">Intestazione</label>
            <input id="header" type="text" formControlName="header" placeholder="Es: Al Personale Docente...">
            <p class="text-danger" *ngIf="!editForm.get('header')!.valid && editForm.get('header')!.touched">Inserisci un'intestazione</p>
          </div>
        </div>

            <label for="body">Corpo del testo</label>
            <textarea style="height: 150px;" id="body" type="text" formControlName="body" placeholder="Es: Si comunica a tutto il personale docente..." ></textarea>
            <p class="text-danger" *ngIf="!editForm.get('body')!.valid && editForm.get('body')!.touched">Inserisci un testo</p>


            <label for="sign">Firma</label>
            <input id="sign" type="text" formControlName="sign" placeholder="Es: Mario Rossi" >
            <p class="text-danger" *ngIf="!editForm.get('sign')!.valid && editForm.get('sign')!.touched">Inserisci una firma</p>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Chiudi</button>
        <button  [disabled] = '!editForm.valid' type="button" (click)="addCircular()" data-bs-dismiss="modal" style="color: white; font-weight: 400;" class="btn btn-warning">Crea Circolare</button>
      </div>
    </div>
  </div>
</div>
